function [targetLab,LMScoords] = RenGetLabFromMacbeth (index)% function targetLab = RenGetLabFromMacbeth (colorNames)% Calculate the LMS coordinate of the macbeth color board. % 10/08/04  bx wrote it. % Define spectral sampling to be used throughoutS = [400 10 31];wls = SToWls(S);load sur_macbethPetersurfaceList = sur_macbethPeter;load T_cones_ss2;T_cones = SplineCmf(S_cones_ss2,T_cones_ss2,S);S_cones = S;% Load XYZ color matching functionsload T_xyzJuddVos ; T_xyz = 683*SplineCmf(S_xyzJuddVos,T_xyzJuddVos,S);% Define LMS to XYZ and XYZ to LMS transformation matrixM_LMSToXYZ = ((T_cones')\(T_xyz'))';M_XYZToLMS = inv(M_LMSToXYZ);% Calculate whiteXYZwhiteLMS = RenGetLMScoords(19);whiteXYZ = M_LMSToXYZ *whiteLMS;% Calculate LMS coords and convert to XYZ and LabLMScoords = RenGetLMScoords(index);XYZvalues = M_LMSToXYZ * LMScoords ;targetLab = XYZToLab(XYZvalues, whiteXYZ); 